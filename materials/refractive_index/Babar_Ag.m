%% SOURCE: Optical constants of Cu, Ag, and Au revisited
%% https://www.osapublishing.org/ao/fulltext.cfm?uri=ao-54-3-477&id=307739#articleTables
function [ep] = Babar_Ag(lambda)

        %% ASSUMES POSITIVE SIGN CONVNETION
        % wvlen column is in eV

        A = [12.4	-7461.3	878.91
8.266666667	-3557.8	385.58
6.2	-2045.3	167.58
4.96	-1321.5	89.36
4.133333333	-921.87	52.04
3.542857143	-678.29	33.28
3.1	-519.61	22.62
2.755555556	-410.43	16.09
2.48	-332.14	11.87
2.254545455	-274.11	9.02
2.066666667	-229.91	7.02
1.907692308	-195.46	5.56
1.771428571	-168.08	4.5
1.653333333	-145.98	3.73
1.55	-127.9	3.14
1.458823529	-112.92	2.67
1.377777778	-100.34	2.29
1.305263158	-89.71	2
1.24	-80.64	1.76
1.127272727	-66.06	1.37
1.033333333	-54.93	1.08
0.953846154	-46.26	0.89
0.885714286	-39.38	0.74
0.826666667	-33.8	0.64
0.775	-29.25	0.57
0.729411765	-25.48	0.52
0.688888889	-22.32	0.48
0.652631579	-19.64	0.44
0.62	-17.34	0.4
0.59047619	-15.35	0.39
0.563636364	-13.64	0.37
0.539130435	-12.13	0.36
0.516666667	-10.81	0.34
0.496	-9.64	0.32
0.476923077	-8.58	0.31
0.459259259	-7.64	0.29
0.442857143	-6.78	0.27
0.427586207	-5.99	0.25
0.413333333	-5.25	0.23
0.4	-4.57	0.23
0.3875	-3.92	0.2
0.375757576	-3.29	0.22
0.364705882	-2.7	0.25
0.354285714	-2.14	0.31
0.344444444	-1.59	0.36
0.335135135	-1.05	0.39
0.326315789	-0.33	0.4
0.317948718	0.52	0.8
0.31	1.17	1.66
0.302439024	1.19	2.52
0.295238095	0.87	3.08
0.288372093	0.57	3.31
0.281818182	0.35	3.44
0.275555556	0.15	3.48
0.269565217	0.03	3.46
0.263829787	-0.09	3.44
0.258333333	-0.15	3.37
0.253061224	-0.19	3.33
0.248	-0.24	3.27
0.243137255	-0.26	3.2
0.238461538	-0.27	3.13
0.233962264	-0.26	3.08
0.22962963	-0.26	3.04
0.225454545	-0.28	3
0.221428571	-0.3	2.96
0.21754386	-0.32	2.9
0.213793103	-0.35	2.84
0.210169492	-0.37	2.77
0.206666667	-0.39	2.69
12.4	-7461.3	878.91
8.266666667	-3557.8	385.58
6.2	-2045.3	167.58
4.96	-1321.5	89.36
4.133333333	-921.87	52.04
3.542857143	-678.29	33.28
3.1	-519.61	22.62
2.755555556	-410.43	16.09
2.48	-332.14	11.87
2.254545455	-274.11	9.02
2.066666667	-229.91	7.02
1.907692308	-195.46	5.56
1.771428571	-168.08	4.5
1.653333333	-145.98	3.73
1.55	-127.9	3.14
1.458823529	-112.92	2.67
1.377777778	-100.34	2.29
1.305263158	-89.71	2
1.24	-80.64	1.76
1.127272727	-66.06	1.37
1.033333333	-54.93	1.08
0.953846154	-46.26	0.89
0.885714286	-39.38	0.74
0.826666667	-33.8	0.64
0.775	-29.25	0.57
0.729411765	-25.48	0.52
0.688888889	-22.32	0.48
0.652631579	-19.64	0.44
0.62	-17.34	0.4
0.59047619	-15.35	0.39
0.563636364	-13.64	0.37
0.539130435	-12.13	0.36
0.516666667	-10.81	0.34
0.496	-9.64	0.32
0.476923077	-8.58	0.31
0.459259259	-7.64	0.29
0.442857143	-6.78	0.27
0.427586207	-5.99	0.25
0.413333333	-5.25	0.23
0.4	-4.57	0.23
0.3875	-3.92	0.2
0.375757576	-3.29	0.22
0.364705882	-2.7	0.25
0.354285714	-2.14	0.31
0.344444444	-1.59	0.36
0.335135135	-1.05	0.39
0.326315789	-0.33	0.4
0.317948718	0.52	0.8
0.31	1.17	1.66
0.302439024	1.19	2.52
0.295238095	0.87	3.08
0.288372093	0.57	3.31
0.275555556	0.15	3.48
0.269565217	0.03	3.46
0.263829787	-0.09	3.44
0.258333333	-0.15	3.37
0.253061224	-0.19	3.33
0.248	-0.24	3.27
0.238461538	-0.27	3.13
0.233962264	-0.26	3.08
0.22962963	-0.26	3.04
0.225454545	-0.28	3
0.221428571	-0.3	2.96
0.21754386	-0.32	2.9
0.213793103	-0.35	2.84
0.210169492	-0.37	2.77
0.206666667	-0.39	2.69];

        A = A + 1e-4*rand(size(A));
        Palik_lam=A(:,1);
        Palik_kap=A(:,3);
        Palik_n=A(:,2);
        
        assert(lambda<=Palik_lam(1) && lambda>=Palik_lam(length(Palik_lam)), 'out of range')
            
        %first step: interpolate everything
        n = interp1(Palik_lam, Palik_n, lambda);
        k = interp1(Palik_lam, Palik_kap, lambda);


        
        ep = (n+1i*k);


end